{
  "version": 3,
  "sources": ["../../src/index.ts", "../../src/indentString.ts", "../../src/IterableWeakMap.ts", "../../src/IterableWeakSet.ts", "../../src/WeakProxy.ts"],
  "sourcesContent": ["export * from \"./IterableWeakMap\";\r\nexport * from \"./IterableWeakSet\";\r\nexport * from \"./WeakProxy\";", "export default function indentString(str: string, indent: string = \"  \") {\r\n\tconst split = str.trim().split(\"\\n\");\r\n\r\n\treturn split.map(s => `${ indent }${ s }`).join(\"\\n\");\r\n}", "import indentString from \"./indentString\";\r\nimport type { inspect as Inspect, InspectOptions } from \"node:util\";\r\n\r\n\r\n\r\n\r\n/**\r\n * Creates an iterable weak map, values are only considered reachable if the keys are.\r\n */\r\nexport default class IterableWeakMap<K extends object, V>\r\n\textends WeakMap<K, { value: V; ref: WeakRef<K> }>\r\n\timplements Iterable<[K, V]> {\r\n\t#refSet = new Set<WeakRef<K>>();\r\n\t#finalizationGroup = new FinalizationRegistry(IterableWeakMap.#cleanup);\r\n\t#size = 0;\r\n\r\n\tget size() {\r\n\t\treturn this.#size;\r\n\t}\r\n\r\n\tstatic #cleanup({ set, ref, map }: { set: Set<WeakRef<any>>; ref: WeakRef<any>; map: IterableWeakMap<any, any> }) {\r\n\t\tset.delete(ref);\r\n\t\tmap.#size--;\r\n\t}\r\n\r\n\tconstructor(iterable: Iterable<[K, V]> = []) {\r\n\t\tsuper();\r\n\r\n\t\tfor (const [key, value] of iterable)\r\n\t\t\tthis.set(key, value);\r\n\t}\r\n\r\n\t// @ts-expect-error\r\n\tset(key: K, value: V) {\r\n\t\tconst ref = new WeakRef(key);\r\n\r\n\t\tsuper.set(key, { value, ref });\r\n\t\tthis.#refSet.add(ref);\r\n\t\tthis.#finalizationGroup.register(key, {\r\n\t\t\tset: this.#refSet,\r\n\t\t\tref,\r\n\t\t\tmap: this,\r\n\t\t}, ref);\r\n\r\n\t\tthis.#size++;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// @ts-expect-error\r\n\tget(key: K) {\r\n\t\tconst entry = super.get(key);\r\n\r\n\t\treturn entry?.value;\r\n\t}\r\n\r\n\tdelete(key: any): key is K {\r\n\t\tconst entry = super.get(key);\r\n\r\n\t\tif (entry === undefined)\r\n\t\t\treturn this.#size--, false;\r\n\r\n\t\tsuper.delete(key);\r\n\t\tthis.#refSet.delete(entry.ref);\r\n\t\tthis.#finalizationGroup.unregister(entry.ref);\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\thas(key: any): key is K {\r\n\t\treturn super.has(key);\r\n\t}\r\n\r\n\tclear() {\r\n\t\tfor (const [key] of this)\r\n\t\t\tthis.delete(key);\r\n\t}\r\n\r\n\tforEach<This = undefined>(callbackfn: (this: This, key: K, value: V, map: this) => void, thisArg: This = undefined as This) {\r\n\t\tfor (const [key, value] of this)\r\n\t\t\tcallbackfn.call(thisArg, key, value, this);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn [...this];\r\n\t}\r\n\r\n\t* [Symbol.iterator]() {\r\n\t\tfor (const ref of this.#refSet) {\r\n\t\t\tconst key = ref.deref();\r\n\r\n\t\t\tif (key === undefined) {\r\n\t\t\t\tthis.#refSet.delete(ref);\r\n\t\t\t\tthis.#size--;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst { value } = super.get(key)!;\r\n\r\n\t\t\tyield [key, value] as [K, V];\r\n\t\t}\r\n\t}\r\n\r\n\t* entries() {\r\n\t\tyield* this[Symbol.iterator]();\r\n\t}\r\n\r\n\t* keys() {\r\n\t\tfor (const [key] of this)\r\n\t\t\tyield key;\r\n\t}\r\n\r\n\t* values() {\r\n\t\tfor (const [, value] of this)\r\n\t\t\tyield value;\r\n\t}\r\n\r\n\t[Symbol.for(\"nodejs.util.inspect.custom\")](depth: number, options: InspectOptions, inspect: typeof Inspect) {\r\n\t\tconst { size } = this,\r\n\t\t\t{ maxArrayLength = 100 } = options,\r\n\t\t\tresult: [any, any][] = [],\r\n\t\t\tnewline = size > 4 ? \"\\n\" : \" \",\r\n\t\t\tindent = size > 4 ? \"  \" : \"\";\r\n\r\n\t\tif (size === 0)\r\n\t\t\treturn `${ IterableWeakMap.name }(${ size }) {}`;\r\n\r\n\t\tfor (const [key, value] of this)\r\n\t\t\tresult.push([\r\n\t\t\t\tinspect(key, { ...options, depth: depth + 1 }),\r\n\t\t\t\tinspect(value, { ...options, depth: depth + 1 }),\r\n\t\t\t]);\r\n\r\n\t\treturn `${ IterableWeakMap.name }(${ size }) {${ newline }${\r\n\t\t\tresult\r\n\t\t\t\t.slice(0, maxArrayLength!)\r\n\t\t\t\t.map(([k, v]) => indentString(`${ k } => ${ v }`, indent))\r\n\t\t\t\t.join(`,${ newline }`)\r\n\t\t}${ result.length > 1 ? \",\" : \"\" }${\r\n\t\t\tresult.length > maxArrayLength! ? `\\n${ indentString(\"...\", indent) } ${ result.length - maxArrayLength! } more items` : \"\"\r\n\t\t}${ newline }}`;\r\n \t}\r\n}", "import indentString from \"./indentString\";\r\nimport type { inspect as Inspect, InspectOptions } from \"node:util\";\r\n\r\n\r\n\r\n\r\n/**\r\n * An iterable version of {@linkcode WeakSet}. \r\n * \r\n * Works by using {@linkcode FinalizationRegistry} to cleanup reclaimed objects and a backing set of {@linkcode WeakRef | WeakRefs} to track the items of the collection.\r\n */\r\nexport default class IterableWeakSet<V extends object> extends WeakSet<V> implements Iterable<V> {\r\n\t#size = 0;\r\n\t#finalizationGroup = new FinalizationRegistry(IterableWeakSet.#cleanup);\r\n\t#refSet = new Set<WeakRef<V>>();\r\n\t#backingMap = new WeakMap<V, WeakRef<V>>();\r\n\r\n\tget size() {\r\n\t\treturn this.#size;\r\n\t}\r\n\r\n\tstatic #cleanup({\r\n\t\trefSet,\r\n\t\tref,\r\n\t\tset,\r\n\t\tbackingMap,\r\n\t}: {\r\n\t\trefSet: Set<WeakRef<any>>;\r\n\t\tref: WeakRef<any>;\r\n\t\tset: IterableWeakSet<any>;\r\n\t\tbackingMap: WeakMap<any, any>;\r\n\t}) {\r\n\t\tbackingMap.delete(ref);\r\n\t\trefSet.delete(ref);\r\n\t\tset.#size--;\r\n\t}\r\n\r\n\tconstructor(iterable: Iterable<V> = []) {\r\n\t\tsuper();\r\n\r\n\t\tfor (const value of iterable)\r\n\t\t\tthis.add(value);\r\n\t}\r\n\r\n\tadd(value: V) {\r\n\t\tif (this.has(value))\r\n\t\t\treturn this;\r\n\r\n\t\tconst ref = new WeakRef(value);\r\n\r\n\t\tsuper.add(value);\r\n\t\tthis.#refSet.add(ref);\r\n\t\tthis.#backingMap.set(value, ref);\r\n\t\tthis.#finalizationGroup.register(value, {\r\n\t\t\tref,\r\n\t\t\trefSet: this.#refSet,\r\n\t\t\tset: this,\r\n\t\t\tbackingMap: this.#backingMap,\r\n\t\t}, ref);\r\n\t\tthis.#size++;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tdelete(value: any): value is V {\r\n\t\tif (!super.has(value))\r\n\t\t\treturn this.#size--, false;\r\n\r\n\t\tconst ref = this.#backingMap.get(value as V);\r\n\r\n\t\tif (ref === undefined)\r\n\t\t\treturn false;\r\n\r\n \t\tsuper.delete(value as V);\r\n\t\tthis.#refSet.delete(ref);\r\n\t\tthis.#backingMap.delete(value as V);\r\n\t\tthis.#size--;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\thas(value: any): value is V {\r\n\t\treturn super.has(value);\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn [...this];\r\n\t}\r\n\r\n\tforEach<This = undefined>(callbackfn: (this: This, key: V, value: V, set: this) => void, thisArg: This = undefined as This) {\r\n\t\tfor (const value of this)\r\n\t\t\tcallbackfn.call(thisArg, value, value, this);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tfor (const value of this)\r\n\t\t\tthis.delete(value);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t* [Symbol.iterator]() {\r\n\t\tfor (const ref of this.#refSet) {\r\n\t\t\tconst value = ref.deref();\r\n\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\tthis.#refSet.delete(ref);\r\n\t\t\t\tthis.#size--;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tyield value;\r\n\t\t}\r\n\t}\r\n\r\n\t* values() {\r\n\t\tyield* this;\r\n\t}\r\n\r\n\t* keys() {\r\n\t\tyield* this;\r\n\t}\r\n\r\n\t* entries() {\r\n\t\tfor (const v of this)\r\n\t\t\tyield [v, v] as [V, V];\r\n\t}\r\n\r\n\t[Symbol.for(\"nodejs.util.inspect.custom\")](depth: number, options: InspectOptions, inspect: typeof Inspect) {\r\n\t\tconst { size } = this,\r\n\t\t\t{ maxArrayLength = 100 } = options,\r\n\t\t\tresult: string[] = [],\r\n\t\t\tnewline = size > 4 ? \"\\n\" : \" \",\r\n\t\t\tindent = size > 4 ? \"  \" : \"\";\r\n\r\n\t\tif (size === 0)\r\n\t\t\treturn `${ IterableWeakSet.name }(${ size }) {}`;\r\n\r\n\t\tfor (const value of this)\r\n\t\t\tresult.push(\r\n\t\t\t\tinspect(value, { ...options, depth: depth + 1 }),\r\n\t\t\t);\r\n\r\n\t\treturn `${ IterableWeakSet.name }(${ size }) {${ newline }${\r\n\t\t\tresult\r\n\t\t\t\t.slice(0, maxArrayLength!)\r\n\t\t\t\t.map(v => indentString(v, indent))\r\n\t\t\t\t.join(`,${ newline }`)\r\n\t\t}${ result.length > 1 ? \",\" : \"\" }${\r\n\t\t\tresult.length > maxArrayLength! ? `\\n${ indentString(\"...\", indent) } ${ result.length - maxArrayLength! } more items` : \"\"\r\n\t\t}${ newline }}`;\r\n \t}\r\n}", "/* eslint-disable one-var */\r\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\r\n/* eslint-disable @typescript-eslint/no-redeclare */\r\n/* eslint-disable @typescript-eslint/no-extra-parens */\r\nconst refMap = new WeakMap<object, WeakRef<object>>(),\r\n\tplaceholderMap = new WeakMap<object, WeakRef<object>>(),\r\n\tweakProxyHandlers = new WeakMap<object, WeakProxyHandler<object>>(),\r\n\tfinalizers = new FinalizationRegistry<{ revoke(): void; proxy: object; placeholder: object }>(({ proxy, revoke, placeholder }) => {\r\n\t\trefMap.delete(proxy);\r\n\t\tplaceholderMap.delete(placeholder);\r\n\t\trevoke();\r\n\r\n\t\t// Invoke finalizer from proxy if there is one\r\n\t\tgetWeakProxyFinalizer(placeholder)?.finalize?.call(getWeakProxyFinalizer(placeholder));\r\n\t});\r\n\r\n\r\ntype WeakProxyCreator = new <T extends object>(object: T, handler?: WeakProxyHandler<T>) => { proxy: T; revoke(): void };\r\ninterface WeakProxy {\r\n\tnew <T extends object>(object: T, handler?: WeakProxyHandler<T>): T;\r\n\trevocable <T extends object>(object: T, handler?: WeakProxyHandler<T>): { proxy: T; revoke(): void };\r\n}\r\n\r\ninterface WeakProxyHandler<T extends object> extends ProxyHandler<T> {\r\n\t/**\r\n\t * Invoked after the proxy's target has been reclaimed.\r\n\t */\r\n\tfinalize?(): void;\r\n}\r\n\r\ntype TupleToIntersection<T extends any[]> = T extends [infer U, ...infer R] ? TupleToIntersection<R> & U : {};\r\n\r\nfunction cloneProperties<T extends object, O extends object[]>(object: T, ...items: [...O]) {\r\n\tfor (const item of items)\r\n\t\tfor (const [key, desc] of Object.entries(Object.getOwnPropertyDescriptors(item)))\r\n\t\t\tObject.defineProperty(object, key, desc);\r\n\r\n\r\n\treturn object as T & TupleToIntersection<O>;\r\n}\r\n\r\nfunction isConstructable(value: any): value is new (...args: any[]) => any {\r\n\tif (typeof value !== \"function\")\r\n\t\treturn false;\r\n\tconst { proxy: p, revoke } = Proxy.revocable(value, { construct() { return value; } });\r\n\tlet res: boolean;\r\n\r\n\ttry {\r\n\t\tnew p();\r\n\r\n\t\tres = true;\r\n\t} catch {\r\n\t\tres = false;\r\n\t}\r\n\r\n\trevoke();\r\n\r\n\treturn res;\r\n}\r\n\r\nfunction isCallable(value: any): value is (...args: any[]) => any {\r\n\tif (typeof value !== \"function\")\r\n\t\treturn false;\r\n\tconst { proxy: p, revoke } = Proxy.revocable(value, { apply() { return value; } });\r\n\tlet res: boolean;\r\n\r\n\ttry {\r\n\t\tp();\r\n\r\n\t\tres = true;\r\n\t} catch {\r\n\t\tres = false;\r\n\t}\r\n\r\n\trevoke();\r\n\r\n\treturn res;\r\n}\r\n\r\nfunction derefPlaceholder(target: object) {\r\n\tconst object = placeholderMap.get(target)!.deref();\r\n\r\n\tif (object === undefined)\r\n\t\tthrow new ReferenceError(\"Cannot reference weak proxy who's target has been reclaimed\");\r\n\r\n\treturn object;\r\n}\r\n\r\nfunction getWeakProxyHandler(placeholder: object) {\r\n\treturn weakProxyHandlers.get(placeholder)!;\r\n}\r\n\r\nObject.defineProperty(invokeWeakProxyHandlerOrDefault, \"name\", { value: \"\" });\r\n\r\nfunction invokeWeakProxyHandlerOrDefault<N extends keyof WeakProxyHandler<any>>(placeholder: object, name: N, ...args: Parameters<WeakProxyHandler<any>[N] & {}>) {\r\n\tconst handler = getWeakProxyHandler(placeholder);\r\n\r\n\treturn handler[name]!.call(handler, ...args) as ReturnType<WeakProxyHandler<any>[N] & {}>;\r\n}\r\n\r\nfunction getWeakProxyFinalizer(proxy: object) {\r\n\treturn weakProxyHandlers.get(proxy);\r\n}\r\n\r\nexport function isWeakProxy<T>(value: T): value is IsWeakProxy & T {\r\n\treturn refMap.has(value as any);\r\n}\r\n\r\nconst baseProxyHandler = {\r\n\tapply(target, thisArg, args) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"apply\", derefPlaceholder(target) as any, thisArg, args);\r\n\t},\r\n\tconstruct(target, args, newTarget) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"construct\", derefPlaceholder(target) as any, args, newTarget);\r\n\t},\r\n\tgetOwnPropertyDescriptor(target, key) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"getOwnPropertyDescriptor\", derefPlaceholder(target), key);\r\n\t},\r\n\tget(target, key, receiver) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"get\", derefPlaceholder(target), key, derefPlaceholder(target));\r\n\t},\r\n\tset(target, key, value) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"set\", derefPlaceholder(target), key, value, derefPlaceholder(target));\r\n\t},\r\n\thas(target, key) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"has\", derefPlaceholder(target), key);\r\n\t},\r\n\tdefineProperty(target, key, attributes) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"defineProperty\", derefPlaceholder(target), key, attributes);\r\n\t},\r\n\tdeleteProperty(target, key) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"deleteProperty\", derefPlaceholder(target), key);\r\n\t},\r\n\tisExtensible(target) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"isExtensible\", derefPlaceholder(target));\r\n\t},\r\n\tpreventExtensions(target) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"preventExtensions\", derefPlaceholder(target));\r\n\t},\r\n\tgetPrototypeOf(target) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"getPrototypeOf\", derefPlaceholder(target));\r\n\t},\r\n\tsetPrototypeOf(target, prototype) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"setPrototypeOf\", derefPlaceholder(target), prototype);\r\n\t},\r\n\townKeys(target) {\r\n\t\treturn invokeWeakProxyHandlerOrDefault(target, \"ownKeys\", derefPlaceholder(target));\r\n\t},\r\n} satisfies ProxyHandler<object>,\r\n\r\n\tWeakProxyConstructor = function WeakProxy<T extends object>(object: T, handler: WeakProxyHandler<T> = {} as WeakProxyHandler<T>) {\r\n\t\tif (typeof object !== \"object\" || !object)\r\n\t\t\tthrow new TypeError(\"Cannot create weak proxy with a non-object as target or handler\");\r\n\r\n\t\tconst callable = isCallable(object),\r\n\t\t\tconstructable = isConstructable(object),\r\n\t\t\tplaceholder = callable && constructable\r\n\t\t\t\t? new Function()\r\n\t\t\t\t: callable && !constructable\r\n\t\t\t\t\t? () => undefined\r\n\t\t\t\t\t: !callable && constructable\r\n\t\t\t\t\t\t? class {}\r\n\t\t\t\t\t\t: Object.create(Object.prototype),\r\n\r\n\t\t\t{ proxy, revoke } = Proxy.revocable(placeholder as object, baseProxyHandler),\r\n\t\t\tmergedHandler = cloneProperties({}, Reflect, handler),\r\n\t\t\tref = new WeakRef(object);\r\n\r\n\t\t// Register handlers for when the target is collected\r\n\t\tfinalizers.register(object, { revoke, proxy, placeholder }, proxy);\r\n\t\trefMap.set(proxy, ref);\r\n\t\tplaceholderMap.set(placeholder, ref);\r\n\r\n\t\t// Register weak proxy handlers\r\n\t\tweakProxyHandlers.set(placeholder, mergedHandler);\r\n\r\n\t\treturn { proxy: proxy as T, revoke };\r\n\t} as any as WeakProxyCreator,\r\n\r\n\trevocable = <T extends object>(target: T, handler?: WeakProxyHandler<T>) => {\r\n\t\tconst p = new WeakProxyConstructor(target, handler);\r\n\t},\r\n\r\n\tWeakProxy = function<T extends object>(target: T, handler?: WeakProxyHandler<T>) {\r\n\t\tif (!new.target)\r\n\t\t\tthrow new TypeError(`Constructor ${ WeakProxy.name } requires 'new'`);\r\n\r\n\t\treturn new WeakProxyConstructor(target, handler).proxy;\r\n\t} as any as WeakProxy;\r\n\r\n\r\ndeclare const SymbolIsWeakProxy: unique symbol;\r\nexport type IsWeakProxy = { readonly [SymbolIsWeakProxy]: typeof SymbolIsWeakProxy };\r\n\r\nWeakProxy.prototype = undefined;\r\nObject.defineProperty(WeakProxy, \"revocable\", {\r\n\tvalue: revocable,\r\n\tenumerable: false,\r\n\tconfigurable: true,\r\n\twritable: true,\r\n});\r\n\r\nexport default WeakProxy;\r\nexport { revocable, WeakProxy };"],
  "mappings": "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",
  "names": ["WeakProxy", "_size", "_finalizationGroup", "_refSet", "_cleanup", "cleanup_fn", "WeakProxy"]
}
